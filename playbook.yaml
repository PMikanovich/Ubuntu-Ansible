- name: Update web servers
  hosts: hosts
  remote_user: administrator
  become: yes
  become_method: sudo

  tasks:
  - name: Install dependencies
    ansible.builtin.apt:
      name: "{{ item }}"
      state: present
    loop:
      - apache2
      - ghostscript
      - libapache2-mod-php
      - mysql-server
      - php
      - php-bcmath
      - php-curl
      - php-imagick
      - php-intl
      - php-json
      - php-mbstring
      - php-mysql
      - php-xml
      - php-zip
  - name: Add wordpress user
    ansible.builtin.user:
      name: www-data
      uid: 1040
  - name: Create a directory if it does not exist
    ansible.builtin.file:
      path: /srv/www
      state: directory
      owner: www-data
      mode: '0755'
  - name: download tar wordpress
    ansible.builtin.unarchive:
      src: https://wordpress.org/latest.tar.gz
      dest: /srv/www
      remote_src: yes
      owner: www-data  # need to check permissions 
